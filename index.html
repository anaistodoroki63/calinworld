<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CalinWorld ‚Äî Le monde des c√¢lins</title>
  <meta name="description" content="CalinWorld ‚Äî un espace chaleureux pour partager douceur, bien-√™tre et moments de r√©confort." />
  <meta name="theme-color" content="#FF7AA2" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#fff7fb;
      --primary:#FF6F91;
      --accent:#FFB3C6;
      --muted:#6b6b76;
      --card:#ffffff;
      --radius:12px;
      --container-max:1100px;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:linear-gradient(180deg,var(--bg), #fff);
      color:#1a1a1a;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.5;
    }
    .container{max-width:var(--container-max);margin:0 auto;padding:0 1rem;}
    header{padding:1rem 0;position:sticky;top:0;background:rgba(255,255,255,0.82);backdrop-filter:blur(6px);z-index:60}
    .nav{display:flex;align-items:center;justify-content:space-between;gap:1rem}
    .brand{display:flex;align-items:center;gap:.75rem;text-decoration:none;color:inherit}
    .brand img{width:44px;height:44px;border-radius:8px;object-fit:cover}
    .brand h1{font-size:1.05rem;margin:0;font-weight:700}
    nav ul{list-style:none;margin:0;padding:0;display:flex;gap:1rem;align-items:center}
    nav a{color:var(--muted);text-decoration:none;font-weight:600}
    .cta{background:var(--primary);color:white;padding:.45rem .75rem;border-radius:10px;text-decoration:none;font-weight:700}

    /* auth button */
    .auth-btn {
      background:transparent;border:2px solid transparent;padding:.4rem .65rem;border-radius:10px;cursor:pointer;font-weight:700;
      color:var(--primary);display:inline-flex;align-items:center;gap:.5rem;
    }
    .auth-btn.logged{background:linear-gradient(90deg,var(--primary),var(--accent));color:white;border-color:transparent}

    /* layout updated */
    .hero{
      padding:3.2rem 0 2rem;
      display:grid;
      grid-template-columns: 1fr 360px;
      gap:2rem;
      align-items:start;
    }
    .hero-inner{display:flex;flex-direction:column;gap:1.2rem}
    .eye-catch{font-size:2rem;font-weight:700;color:#331026}
    .lead{color:var(--muted);max-width:60ch}

    /* illustration area */
    .hero-illustration{
      width:100%;
      height:260px;
      border-radius:18px;
      background:
        linear-gradient(135deg,var(--primary),var(--accent));
      display:flex;
      align-items:center;
      justify-content:center;
      color:white;
      font-weight:700;
      box-shadow:0 8px 30px rgba(255,111,145,0.18);
      position:relative;
      overflow:hidden;
    }
    .hero-illustration-inner{
      width:100%;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      gap:14px;
      padding:1rem;
      position:relative;
      z-index:2;
    }

    .hero-illustration .overlay-image{
      position:absolute;
      inset:0;
      background-position:center;
      background-size:cover;
      background-repeat:no-repeat;
      opacity:0.95;
      border-radius:18px;
      z-index:1;
      pointer-events:none;
    }

    /* Visible hug button (z-index high + contrasting background) */
    .hug-btn {
      background:#ffffff;
      color:var(--primary);
      padding:.8rem 1.2rem;
      border-radius:999px;
      border:none;
      cursor:pointer;
      font-weight:800;
      box-shadow:0 12px 30px rgba(160,60,90,0.14);
      transform:translateY(0);
      transition:transform .12s ease, box-shadow .12s ease;
      z-index:3;
      position:relative;
      font-size:1rem;
    }
    .hug-btn:active{ transform:translateY(1px) scale(.995) }

    .emoji-row{
      display:flex;
      gap:1rem;
      align-items:center;
      justify-content:center;
      margin-top:6px;
      color:#ffbfcd;
      font-size:26px;
      filter:drop-shadow(0 6px 12px rgba(0,0,0,0.06));
      z-index:2;
    }

    .small{ color:var(--muted); margin-top:6px; z-index:2; position:relative; }

    /* friends list */
    .friends-card{
      background:var(--card);
      border-radius:12px;
      box-shadow:0 8px 24px rgba(20,20,20,0.05);
      padding:1rem;
      max-height:520px;
      overflow:auto;
    }
    .friends-card h3{margin:0 0 .5rem;font-size:1.05rem;color:var(--primary)}
    .add-row{display:flex;gap:.5rem;margin-bottom:.75rem}
    .add-row input{flex:1;padding:.55rem;border-radius:10px;border:1px solid rgba(10,10,10,0.06)}
    .add-row button{padding:.55rem .8rem;border-radius:10px;border:none;background:var(--primary);color:white;cursor:pointer}

    .friends-list{display:flex;flex-direction:column;gap:.5rem}
    .friend {
      display:flex;
      align-items:center;
      gap:.6rem;
      justify-content:space-between;
      padding:.5rem;
      border-radius:10px;
      border:1px solid rgba(10,10,10,0.03);
      background:linear-gradient(180deg,#fff,#fff);
    }
    .friend .left{display:flex;align-items:center;gap:.6rem}
    .friend .name{font-weight:600}
    .friend .controls{display:flex;gap:.5rem;align-items:center}
    .count-badge{background:linear-gradient(90deg,var(--primary),var(--accent));color:white;padding:.25rem .5rem;border-radius:999px;font-weight:700;min-width:36px;text-align:center}

    .friends-actions{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:.5rem}
    .btn-ghost{background:transparent;border:1px solid rgba(0,0,0,0.06);padding:.4rem .65rem;border-radius:8px;cursor:pointer}

    /* modal auth */
    .modal-backdrop{
      position:fixed;inset:0;background:rgba(12,12,12,0.45);display:none;align-items:center;justify-content:center;z-index:120;
    }
    .modal{
      background:white;border-radius:12px;padding:1.25rem 1.25rem;width:320px;box-shadow:0 18px 40px rgba(0,0,0,0.18);
    }
    .modal h3{margin:0 0 .5rem}
    .modal input{width:100%;padding:.6rem;border-radius:8px;border:1px solid rgba(0,0,0,0.08);margin-bottom:.5rem}

    /* emoji flying animation */
    .emoji-fly {
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      bottom:110%;
      pointer-events:none;
      font-size:28px;
      animation:rise 1s ease-out forwards;
      opacity:0;
      filter:drop-shadow(0 6px 18px rgba(0,0,0,0.08));
    }
    @keyframes rise {
      0%{opacity:0; transform:translateX(-50%) translateY(0) scale(0.8)}
      20%{opacity:1}
      100%{opacity:0; transform:translateX(-50%) translateY(-160px) scale(1.05)}
    }

    /* gallery placeholders */
    .gallery{display:grid;grid-template-columns:repeat(3,1fr);gap:0.5rem;margin-top:1rem}
    .gallery img{width:100%;display:block;height:120px;object-fit:cover;border-radius:8px}

    @media (max-width:980px){
      .hero{grid-template-columns:1fr}
      .friends-card{order:2}
      .hero-illustration{height:220px}
    }
    @media (max-width:600px){
      .hero-illustration{height:180px}
      .emoji-row{font-size:22px}
    }
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <a class="brand" href="#">
        <img src="https://via.placeholder.com/80x80.png?text=Logo" alt="CalinWorld logo">
        <h1>CalinWorld</h1>
      </a>

      <nav aria-label="Navigation principale">
        <ul>
      </nav>

      <!-- Auth button -->
      <div>
        <button id="authBtn" class="auth-btn" type="button">Se connecter</button>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="hero" id="home">
      <div>
        <div class="hero-inner">
          <div>
            <div class="eye-catch">Bienvenue dans le monde des c√¢lins</div>
            <p class="lead">CalinWorld est un espace chaleureux pens√© pour apporter douceur, r√©confort et liens humains ‚Äî en ligne et en vrai.</p>
          </div>

          <div style="display:flex;gap:0.75rem;align-items:center;justify-content:flex-start;margin-top:.5rem">
            <a href="#features" class="btn-ghost">En savoir plus</a>
          </div>

          <div style="margin-top:1.25rem">
            <div class="hero-illustration">
              <div class="overlay-image" style="background-image:url('https://picsum.photos/1200/400?random=42');"></div>
              <div class="hero-illustration-inner" role="region" aria-label="Zone principale">
                <button id="hugInHero" class="hug-btn" aria-live="polite" aria-pressed="false">Donne‚Äëmoi un c√¢lin</button>
                <div class="emoji-row" id="heroEmojiRow" aria-hidden="false">
                  <span>ü§ó</span>
                  <span>üíñ</span>
                  <span>ü§ó</span>
                </div>
                <div class="small" id="heroTotal" style="color:var(--muted)">C√¢lins re√ßus : <strong id="heroTotalCount">0</strong></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Friends card on the right -->
      <aside class="friends-card" aria-labelledby="friendsTitle">
        <h3 id="friendsTitle">Liste d'ami¬∑e¬∑s</h3>

        <div class="add-row" role="form" aria-label="Ajouter un ami">
          <input id="friendName" placeholder="Ajouter un ami" aria-label="Nom de l'ami">
          <button id="addFriend" type="button">Ajouter</button>
        </div>

        <div class="friends-list" id="friendsList" aria-live="polite">
          <!-- friends entries rendered here -->
        </div>

        <div class="friends-actions" style="margin-top:.75rem">
          <button id="selectAll" class="btn-ghost" type="button">Tout s√©lectionner</button>
          <button id="clearSel" class="btn-ghost" type="button">D√©cocher</button>
          <button id="hugSelected" class="btn-ghost" type="button">C√¢liner la s√©lection</button>
          <button id="hugAll" class="btn-ghost" type="button">C√¢liner tous</button>
          <button id="resetAll" class="btn-ghost" type="button">R√©initialiser compteurs</button>
        </div>
      </aside>
    </section>

    <section id="gallery" style="padding-top:1.5rem">
      <h2 style="margin-bottom:.5rem">Galerie</h2>
      <p class="small" style="margin-bottom:1rem">Quelques moments captur√©s ‚Äî placeholders temporaires.</p>
      <div class="gallery">
        <img src="https://picsum.photos/seed/1/400/300" alt="Photo 1">
        <img src="https://picsum.photos/seed/2/400/300" alt="Photo 2">
        <img src="https://picsum.photos/seed/3/400/300" alt="Photo 3">
        <img src="https://picsum.photos/seed/4/400/300" alt="Photo 4">
        <img src="https://picsum.photos/seed/5/400/300" alt="Photo 5">
        <img src="https://picsum.photos/seed/6/400/300" alt="Photo 6">
      </div>
    </section>
  </main>

  <footer style="padding:2rem 0;color:var(--muted);text-align:center">
    ¬© <span id="year"></span> CalinWorld ‚Äî Tous droits r√©serv√©s.
  </footer>

  <!-- Auth modal -->
  <div id="authModal" class="modal-backdrop" role="dialog" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="authTitle">
      <h3 id="authTitle">Se connecter</h3>
      <p class="small" style="margin-top:0">Entrez votre pseudo (il sera stock√© localement)</p>
      <input id="authName" placeholder="Ton pseudo" aria-label="Pseudo">
      <div style="display:flex;gap:.5rem;justify-content:flex-end;margin-top:.5rem">
        <button id="authCancel" class="btn-ghost" type="button">Annuler</button>
        <button id="authSubmit" class="cta" type="button">Se connecter</button>
      </div>
    </div>
  </div>

  <script>
    // -----------------------
    // AUTH (connexion) layer
    // -----------------------
    (function(){
      const AUTH_KEY = 'calin_user_v1';
      const authBtn = document.getElementById('authBtn');
      const modal = document.getElementById('authModal');
      const authNameInput = document.getElementById('authName');
      const authSubmit = document.getElementById('authSubmit');
      const authCancel = document.getElementById('authCancel');

      function getCurrentUser(){
        try {
          const raw = localStorage.getItem(AUTH_KEY);
          return raw ? JSON.parse(raw) : null;
        } catch(e){ return null; }
      }
      function setCurrentUser(u){
        if (!u) { localStorage.removeItem(AUTH_KEY); return; }
        localStorage.setItem(AUTH_KEY, JSON.stringify(u));
      }

      function openModal(){
        if (!modal) return;
        modal.style.display = 'flex';
        modal.setAttribute('aria-hidden','false');
        authNameInput && authNameInput.focus();
      }
      function closeModal(){
        if (!modal) return;
        modal.style.display = 'none';
        modal.setAttribute('aria-hidden','true');
        authNameInput.value = '';
      }

      function renderAuth(){
        const user = getCurrentUser();
        if (!authBtn) return;
        if (user && user.name){
          authBtn.classList.add('logged');
          authBtn.textContent = `Bonjour, ${user.name} ‚Ä¢ D√©connexion`;
        } else {
          authBtn.classList.remove('logged');
          authBtn.textContent = 'Se connecter';
        }
      }

      // open modal on click when not logged
      authBtn && authBtn.addEventListener('click', ()=>{
        const user = getCurrentUser();
        if (user && user.name){
          // logged in -> logout
          if (confirm('Se d√©connecter ?')) {
            setCurrentUser(null);
            renderAuth();
          }
        } else {
          openModal();
        }
      });

      // submit login
      authSubmit && authSubmit.addEventListener('click', ()=>{
        const name = (authNameInput && authNameInput.value || '').trim();
        if (!name) { alert('Choisis un pseudo.'); authNameInput.focus(); return; }
        setCurrentUser({ name, loggedAt: Date.now() });
        renderAuth();
        closeModal();
      });

      authCancel && authCancel.addEventListener('click', closeModal);

      // close modal on backdrop click
      modal && modal.addEventListener('click', (e)=>{
        if (e.target === modal) closeModal();
      });

      // init
      renderAuth();

      // expose helper to other scripts
      window.getCurrentUser = getCurrentUser;
    })();

    // -----------------------
    // MAIN app (friends + hugs)
    // -----------------------
    document.addEventListener('DOMContentLoaded', () => {
      // Keys
      const FRIENDS_KEY = 'calin_friends_v1';
      const TOTAL_KEY = 'calin_total_v1';

      // Elements
      const friendNameInput = document.getElementById('friendName');
      const addFriendBtn = document.getElementById('addFriend');
      const friendsListEl = document.getElementById('friendsList');
      const selectAllBtn = document.getElementById('selectAll');
      const clearSelBtn = document.getElementById('clearSel');
      const hugSelectedBtn = document.getElementById('hugSelected');
      const hugAllBtn = document.getElementById('hugAll');
      const resetAllBtn = document.getElementById('resetAll');
      const heroBtn = document.getElementById('hugInHero');
      const heroTotalCountEl = document.getElementById('heroTotalCount');
      const friendsTitle = document.getElementById('friendsTitle');

      // State
      function loadFriends(){ try { return JSON.parse(localStorage.getItem(FRIENDS_KEY) || '[]'); } catch(e){ return []; } }
      function saveFriends(f){ localStorage.setItem(FRIENDS_KEY, JSON.stringify(f)); }
      function loadTotal(){ return parseInt(localStorage.getItem(TOTAL_KEY) || '0', 10); }
      function saveTotal(){ localStorage.setItem(TOTAL_KEY, String(total)); }
      function uid(){ return 'f_' + Math.random().toString(36).slice(2,9); }

      let friends = loadFriends();
      let total = loadTotal();

      // If empty, add demo friends so the list is visible immediately
      if (friends.length === 0){
        friends = [{ id: uid(), name: '', count: 0 }, { id: uid(), name: 'Lucas', count: 0 }];
        saveFriends(friends);
      }

      function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[c]); }

      function renderFriends(){
        if (!friendsListEl) return;
        friendsListEl.innerHTML = '';
        if (friends.length === 0){
          friendsListEl.innerHTML = '<div class="small" style="text-align:center;padding:.8rem;color:var(--muted)">Aucun¬∑e ami¬∑e ‚Äî ajoute en un¬∑e ci‚Äëdessous.</div>';
          updateHeroTotal();
          return;
        }
        friends.forEach(f => {
          const el = document.createElement('div');
          el.className = 'friend';
          el.dataset.id = f.id;
          el.innerHTML = `
            <div class="left">
              <label style="display:flex;align-items:center;gap:.6rem;cursor:pointer">
                <input type="checkbox" class="sel" aria-label="S√©lectionner ${escapeHtml(f.name)}">
                <span class="name">${escapeHtml(f.name)}</span>
              </label>
            </div>
            <div class="controls">
              <div class="count-badge" aria-live="polite">${f.count}</div>
              <button class="btn-ghost btn-remove" title="Supprimer ${escapeHtml(f.name)}" aria-label="Supprimer">‚úñ</button>
            </div>
          `;
          const removeBtn = el.querySelector('.btn-remove');
          const checkbox = el.querySelector('.sel');
          removeBtn && removeBtn.addEventListener('click', ()=>{
            if (!confirm(`Supprimer ${f.name} ?`)) return;
            friends = friends.filter(x => x.id !== f.id);
            saveFriends(friends);
            renderFriends();
          });
          checkbox && checkbox.addEventListener('change', updateSelectedCount);
          friendsListEl.appendChild(el);
        });
        updateSelectedCount();
        updateHeroTotal();
      }

      function getSelectedIds(){
        if (!friendsListEl) return [];
        const checks = Array.from(friendsListEl.querySelectorAll('.sel'));
        return checks.filter(c=>c.checked).map(c => c.closest('.friend').dataset.id);
      }
      function updateSelectedCount(){
        const n = getSelectedIds().length;
        if (friendsTitle) friendsTitle.textContent = `Liste d'ami¬∑e¬∑s${n ? ' ‚Äî ' + n + ' s√©lectionn√©'+(n>1?'¬∑e¬∑s':'') : ''}`;
      }

      function addFriend(){
        if (!friendNameInput) return;
        const name = friendNameInput.value.trim();
        if (!name) return;
        if (friends.some(p => p.name.toLowerCase() === name.toLowerCase())){
          alert('Cette personne existe d√©j√†.');
          friendNameInput.value = '';
          return;
        }
        friends.push({ id: uid(), name, count: 0 });
        saveFriends(friends);
        friendNameInput.value = '';
        friendNameInput.focus();
        renderFriends();
      }
      addFriendBtn && addFriendBtn.addEventListener('click', addFriend);
      friendNameInput && friendNameInput.addEventListener('keydown', e=>{
        if (e.key === 'Enter'){ e.preventDefault(); addFriend(); }
      });

      function showEmojiBurst(n){
        const emojis = ['ü§ó','üíñ','‚ú®','ü§ç'];
        for (let i=0;i<Math.min(n,12);i++){
          const el = document.createElement('div');
          el.className = 'emoji-fly';
          el.style.left = `calc(50% + ${Math.floor(Math.random()*240 - 120)}px)`;
          el.style.bottom = `${110 + Math.floor(Math.random()*30)}%`;
          el.textContent = emojis[Math.floor(Math.random()*emojis.length)];
          document.body.appendChild(el);
          setTimeout(()=> el.style.animationDelay = (i*40)+'ms', 10);
          setTimeout(()=> el.remove(), 1500 + i*80);
        }
      }

      function hugIds(ids){
        if (!ids || ids.length === 0) return;
        friends = friends.map(f => ids.includes(f.id) ? {...f, count: (f.count||0)+1} : f );
        total += ids.length;
        saveFriends(friends); saveTotal();
        renderFriends();
        showEmojiBurst(Math.min(8, ids.length*2));
      }

      hugSelectedBtn && hugSelectedBtn.addEventListener('click', ()=>{
        const ids = getSelectedIds();
        if (ids.length === 0){ alert('Aucune personne s√©lectionn√©e.'); return; }
        hugIds(ids);
      });
      hugAllBtn && hugAllBtn.addEventListener('click', ()=>{
        if (friends.length === 0){ alert('Aucun¬∑e ami¬∑e √† c√¢liner.'); return; }
        hugIds(friends.map(f=>f.id));
      });
      resetAllBtn && resetAllBtn.addEventListener('click', ()=>{
        if (!confirm('R√©initialiser tous les compteurs ?')) return;
        friends = friends.map(f => ({...f, count:0}));
        total = 0;
        saveFriends(friends); saveTotal();
        renderFriends();
      });

      // hero button behavior
      heroBtn && heroBtn.addEventListener('click', ()=>{
        const ids = getSelectedIds();
        if (ids.length > 0) hugIds(ids);
        else {
          total += 1;
          saveTotal();
          updateHeroTotal();
          showEmojiBurst(6);
        }
      });

      function updateHeroTotal(){
        if (heroTotalCountEl) heroTotalCountEl.textContent = total;
      }

      // select/clear
      selectAllBtn && selectAllBtn.addEventListener('click', ()=>{
        document.querySelectorAll('.friends-list .sel').forEach(c=>c.checked=true);
        updateSelectedCount();
      });
      clearSelBtn && clearSelBtn.addEventListener('click', ()=>{
        document.querySelectorAll('.friends-list .sel').forEach(c=>c.checked=false);
        updateSelectedCount();
      });

      // storage sync
      window.addEventListener('storage', e=>{
        if (e.key === FRIENDS_KEY){
          friends = loadFriends();
          renderFriends();
        } else if (e.key === TOTAL_KEY){
          total = loadTotal();
          updateHeroTotal();
        }
      });

      // initial render
      updateHeroTotal();
      renderFriends();
      friendNameInput && friendNameInput.focus();
      document.getElementById('year').textContent = new Date().getFullYear();
    });
  </script>
</body>
</html>
